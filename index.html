<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qu·∫£n L√Ω Nh√¢n S·ª±</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fff5f5 0%, #ffe0e0 100%);
            min-height: 100vh;
        }

        .header {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
            padding: 20px 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 0 20px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.1);
            border-left: 5px solid #dc2626;
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-card h3 {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .stat-card .number {
            font-size: 36px;
            color: #dc2626;
            font-weight: bold;
        }

        .main-section {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #fee;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 25px;
            background: transparent;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 16px;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: #dc2626;
        }

        .tab.active {
            color: #dc2626;
            border-bottom-color: #dc2626;
            font-weight: 600;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 500;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #fee;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #dc2626;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .btn {
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(220, 38, 38, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #dc2626;
            border: 2px solid #dc2626;
        }

        .btn-secondary:hover {
            background: #dc2626;
            color: white;
        }

        .btn-danger {
            background: #fee;
            color: #dc2626;
        }

        .btn-danger:hover {
            background: #dc2626;
            color: white;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        table thead {
            background: linear-gradient(135deg, #dc2626 0%, #991b1b 100%);
            color: white;
        }

        table th,
        table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #fee;
        }

        table tbody tr:hover {
            background: #fff5f5;
        }

        .action-btns {
            display: flex;
            gap: 10px;
        }

        .action-btns button {
            padding: 6px 12px;
            font-size: 12px;
        }

        .search-box {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .search-box input {
            flex: 1;
            min-width: 250px;
            padding: 12px;
            border: 2px solid #fee;
            border-radius: 8px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #fee;
        }

        .modal-header h2 {
            color: #dc2626;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            color: #666;
            cursor: pointer;
        }

        .close-btn:hover {
            color: #dc2626;
        }

        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .badge-active {
            background: #dcfce7;
            color: #166534;
        }

        .badge-inactive {
            background: #fee;
            color: #dc2626;
        }

        .badge-leave {
            background: #fef3c7;
            color: #92400e;
        }

        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
            }

            .header h1 {
                font-size: 22px;
            }

            .stats {
                grid-template-columns: 1fr;
            }

            .main-section {
                padding: 20px;
            }

            table {
                font-size: 12px;
            }

            table th,
            table td {
                padding: 10px 5px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üè¢ H·ªá Th·ªëng Qu·∫£n L√Ω Nh√¢n S·ª±</h1>
        <p>Qu·∫£n l√Ω to√†n di·ªán th√¥ng tin nh√¢n vi√™n, ch·∫•m c√¥ng, l∆∞∆°ng v√† ph√∫c l·ª£i</p>
    </div>

    <div class="container">
        <div class="stats">
            <div class="stat-card">
                <h3>T·ªïng Nh√¢n Vi√™n</h3>
                <div class="number" id="totalEmployees">0</div>
            </div>
            <div class="stat-card">
                <h3>ƒêang L√†m Vi·ªác</h3>
                <div class="number" id="activeEmployees">0</div>
            </div>
            <div class="stat-card">
                <h3>Ngh·ªâ Ph√©p H√¥m Nay</h3>
                <div class="number" id="onLeaveToday">0</div>
            </div>
            <div class="stat-card">
                <h3>Ph√≤ng Ban</h3>
                <div class="number" id="totalDepartments">5</div>
            </div>
        </div>

        <div class="main-section">
            <div class="tabs">
                <button class="tab active" onclick="switchTab('employees')">üë• Nh√¢n Vi√™n</button>
                <button class="tab" onclick="switchTab('attendance')">‚è∞ Ch·∫•m C√¥ng</button>
                <button class="tab" onclick="switchTab('leave')">üèñÔ∏è Ngh·ªâ Ph√©p</button>
                <button class="tab" onclick="switchTab('salary')">üí∞ L∆∞∆°ng</button>
                <button class="tab" onclick="switchTab('reports')">üìä B√°o C√°o</button>
            </div>

            <!-- Tab Nh√¢n Vi√™n -->
            <div id="employees" class="tab-content active">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2 style="color: #dc2626;">Danh S√°ch Nh√¢n Vi√™n</h2>
                    <button class="btn btn-primary" onclick="openAddEmployeeModal()">‚ûï Th√™m Nh√¢n Vi√™n</button>
                </div>

                <div class="search-box">
                    <input type="text" id="searchEmployee" placeholder="üîç T√¨m ki·∫øm theo t√™n, m√£ NV, ph√≤ng ban..." onkeyup="searchEmployees()">
                    <select id="filterDepartment" onchange="searchEmployees()" style="padding: 12px; border: 2px solid #fee; border-radius: 8px;">
                        <option value="">T·∫•t c·∫£ ph√≤ng ban</option>
                        <option value="K·ªπ Thu·∫≠t">K·ªπ Thu·∫≠t</option>
                        <option value="Kinh Doanh">Kinh Doanh</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Nh√¢n S·ª±">Nh√¢n S·ª±</option>
                        <option value="K·∫ø To√°n">K·∫ø To√°n</option>
                    </select>
                </div>

                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>M√£ NV</th>
                                <th>H·ªç T√™n</th>
                                <th>Ph√≤ng Ban</th>
                                <th>Ch·ª©c V·ª•</th>
                                <th>Email</th>
                                <th>SƒêT</th>
                                <th>Tr·∫°ng Th√°i</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="employeeTableBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px; color: #999;">
                                    Ch∆∞a c√≥ nh√¢n vi√™n n√†o. Nh·∫•n "Th√™m Nh√¢n Vi√™n" ƒë·ªÉ b·∫Øt ƒë·∫ßu!
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab Ch·∫•m C√¥ng -->
            <div id="attendance" class="tab-content">
                <h2 style="color: #dc2626; margin-bottom: 20px;">Ch·∫•m C√¥ng H√¥m Nay</h2>
                
                <div class="form-row" style="margin-bottom: 30px;">
                    <div class="form-group">
                        <label>Ch·ªçn Nh√¢n Vi√™n</label>
                        <select id="attendanceEmployee">
                            <option value="">-- Ch·ªçn nh√¢n vi√™n --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ng√†y</label>
                        <input type="date" id="attendanceDate">
                    </div>
                    <div class="form-group">
                        <label>Gi·ªù V√†o</label>
                        <input type="time" id="checkInTime" value="08:00">
                    </div>
                    <div class="form-group">
                        <label>Gi·ªù Ra</label>
                        <input type="time" id="checkOutTime" value="17:00">
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="addAttendance()">‚úÖ L∆∞u Ch·∫•m C√¥ng</button>

                <h3 style="margin: 30px 0 15px; color: #dc2626;">L·ªãch S·ª≠ Ch·∫•m C√¥ng</h3>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Ng√†y</th>
                                <th>Nh√¢n Vi√™n</th>
                                <th>Gi·ªù V√†o</th>
                                <th>Gi·ªù Ra</th>
                                <th>S·ªë Gi·ªù</th>
                                <th>Tr·∫°ng Th√°i</th>
                            </tr>
                        </thead>
                        <tbody id="attendanceTableBody">
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 40px; color: #999;">
                                    Ch∆∞a c√≥ d·ªØ li·ªáu ch·∫•m c√¥ng
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab Ngh·ªâ Ph√©p -->
            <div id="leave" class="tab-content">
                <h2 style="color: #dc2626; margin-bottom: 20px;">Qu·∫£n L√Ω Ngh·ªâ Ph√©p</h2>
                
                <div class="form-row" style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label>Nh√¢n Vi√™n</label>
                        <select id="leaveEmployee">
                            <option value="">-- Ch·ªçn nh√¢n vi√™n --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Lo·∫°i Ngh·ªâ</label>
                        <select id="leaveType">
                            <option value="Ngh·ªâ Ph√©p">Ngh·ªâ Ph√©p</option>
                            <option value="Ngh·ªâ ·ªêm">Ngh·ªâ ·ªêm</option>
                            <option value="Ngh·ªâ Vi·ªác Ri√™ng">Ngh·ªâ Vi·ªác Ri√™ng</option>
                            <option value="Ngh·ªâ Kh√¥ng L∆∞∆°ng">Ngh·ªâ Kh√¥ng L∆∞∆°ng</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>T·ª´ Ng√†y</label>
                        <input type="date" id="leaveStartDate">
                    </div>
                    <div class="form-group">
                        <label>ƒê·∫øn Ng√†y</label>
                        <input type="date" id="leaveEndDate">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>L√Ω Do</label>
                    <textarea id="leaveReason" rows="3" placeholder="Nh·∫≠p l√Ω do ngh·ªâ ph√©p..."></textarea>
                </div>
                
                <button class="btn btn-primary" onclick="addLeave()">üìù ƒêƒÉng K√Ω Ngh·ªâ Ph√©p</button>

                <h3 style="margin: 30px 0 15px; color: #dc2626;">Danh S√°ch ƒê∆°n Ngh·ªâ</h3>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Nh√¢n Vi√™n</th>
                                <th>Lo·∫°i Ngh·ªâ</th>
                                <th>T·ª´ Ng√†y</th>
                                <th>ƒê·∫øn Ng√†y</th>
                                <th>S·ªë Ng√†y</th>
                                <th>L√Ω Do</th>
                                <th>Tr·∫°ng Th√°i</th>
                                <th>Thao T√°c</th>
                            </tr>
                        </thead>
                        <tbody id="leaveTableBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px; color: #999;">
                                    Ch∆∞a c√≥ ƒë∆°n ngh·ªâ ph√©p n√†o
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab L∆∞∆°ng -->
            <div id="salary" class="tab-content">
                <h2 style="color: #dc2626; margin-bottom: 20px;">Qu·∫£n L√Ω L∆∞∆°ng</h2>
                
                <div class="form-row" style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label>Nh√¢n Vi√™n</label>
                        <select id="salaryEmployee">
                            <option value="">-- Ch·ªçn nh√¢n vi√™n --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Th√°ng</label>
                        <input type="month" id="salaryMonth">
                    </div>
                    <div class="form-group">
                        <label>L∆∞∆°ng C∆° B·∫£n (VNƒê)</label>
                        <input type="number" id="baseSalary" placeholder="10000000">
                    </div>
                    <div class="form-group">
                        <label>Ph·ª• C·∫•p (VNƒê)</label>
                        <input type="number" id="allowance" placeholder="2000000">
                    </div>
                </div>
                
                <div class="form-row" style="margin-bottom: 20px;">
                    <div class="form-group">
                        <label>Th∆∞·ªüng (VNƒê)</label>
                        <input type="number" id="bonus" placeholder="0">
                    </div>
                    <div class="form-group">
                        <label>Kh·∫•u Tr·ª´ (VNƒê)</label>
                        <input type="number" id="deduction" placeholder="0">
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="calculateSalary()">üíµ T√≠nh L∆∞∆°ng</button>

                <h3 style="margin: 30px 0 15px; color: #dc2626;">B·∫£ng L∆∞∆°ng</h3>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Th√°ng</th>
                                <th>Nh√¢n Vi√™n</th>
                                <th>L∆∞∆°ng CB</th>
                                <th>Ph·ª• C·∫•p</th>
                                <th>Th∆∞·ªüng</th>
                                <th>Kh·∫•u Tr·ª´</th>
                                <th>Th·ª±c L√£nh</th>
                                <th>Tr·∫°ng Th√°i</th>
                            </tr>
                        </thead>
                        <tbody id="salaryTableBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 40px; color: #999;">
                                    Ch∆∞a c√≥ b·∫£ng l∆∞∆°ng n√†o
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Tab B√°o C√°o -->
            <div id="reports" class="tab-content">
                <h2 style="color: #dc2626; margin-bottom: 20px;">B√°o C√°o Th·ªëng K√™</h2>
                
                <div class="stats">
                    <div class="stat-card">
                        <h3>T·ªïng Chi L∆∞∆°ng Th√°ng N√†y</h3>
                        <div class="number" style="font-size: 24px;" id="totalSalaryThisMonth">0ƒë</div>
                    </div>
                    <div class="stat-card">
                        <h3>T·ªïng S·ªë Ng√†y C√¥ng</h3>
                        <div class="number" id="totalWorkDays">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>T·ªïng Ng√†y Ngh·ªâ</h3>
                        <div class="number" id="totalLeaveDays">0</div>
                    </div>
                    <div class="stat-card">
                        <h3>T·ª∑ L·ªá ƒêi L√†m</h3>
                        <div class="number" style="font-size: 28px;" id="attendanceRate">100%</div>
                    </div>
                </div>

                <h3 style="margin: 30px 0 15px; color: #dc2626;">Nh√¢n Vi√™n Theo Ph√≤ng Ban</h3>
                <div style="overflow-x: auto;">
                    <table>
                        <thead>
                            <tr>
                                <th>Ph√≤ng Ban</th>
                                <th>S·ªë Nh√¢n Vi√™n</th>
                                <th>T·ª∑ L·ªá</th>
                            </tr>
                        </thead>
                        <tbody id="departmentReportBody">
                            <tr>
                                <td colspan="3" style="text-align: center; padding: 40px; color: #999;">
                                    Ch∆∞a c√≥ d·ªØ li·ªáu
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Th√™m/S·ª≠a Nh√¢n Vi√™n -->
    <div id="employeeModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">Th√™m Nh√¢n Vi√™n M·ªõi</h2>
                <button class="close-btn" onclick="closeEmployeeModal()">&times;</button>
            </div>
            
            <form id="employeeForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>M√£ Nh√¢n Vi√™n *</label>
                        <input type="text" id="empId" required placeholder="VD: NV001">
                    </div>
                    <div class="form-group">
                        <label>H·ªç T√™n *</label>
                        <input type="text" id="empName" required placeholder="Nguy·ªÖn VƒÉn A">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Email *</label>
                        <input type="email" id="empEmail" required placeholder="example@company.com">
                    </div>
                    <div class="form-group">
                        <label>S·ªë ƒêi·ªán Tho·∫°i *</label>
                        <input type="tel" id="empPhone" required placeholder="0123456789">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Ph√≤ng Ban *</label>
                        <select id="empDepartment" required>
                            <option value="">-- Ch·ªçn ph√≤ng ban --</option>
                            <option value="K·ªπ Thu·∫≠t">K·ªπ Thu·∫≠t</option>
                            <option value="Kinh Doanh">Kinh Doanh</option>
                            <option value="Marketing">Marketing</option>
                            <option value="Nh√¢n S·ª±">Nh√¢n S·ª±</option>
                            <option value="K·∫ø To√°n">K·∫ø To√°n</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Ch·ª©c V·ª• *</label>
                        <input type="text" id="empPosition" required placeholder="VD: Nh√¢n vi√™n">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y Sinh</label>
                        <input type="date" id="empBirthday">
                    </div>
                    <div class="form-group">
                        <label>Ng√†y V√†o L√†m *</label>
                        <input type="date" id="empJoinDate" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>ƒê·ªãa Ch·ªâ</label>
                    <textarea id="empAddress" rows="2" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ..."></textarea>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 25px;">
                    <button type="submit" class="btn btn-primary" style="flex: 1;">üíæ L∆∞u</button>
                    <button type="button" class="btn btn-secondary" onclick="closeEmployeeModal()" style="flex: 1;">‚ùå H·ªßy</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let employees = [];
        let attendanceRecords = [];
        let leaveRecords = [];
        let salaryRecords = [];
        let editingIndex = -1;

        // Load d·ªØ li·ªáu t·ª´ localStorage khi kh·ªüi ƒë·ªông
        window.onload = function() {
            loadData();
            document.getElementById('attendanceDate').valueAsDate = new Date();
            document.getElementById('salaryMonth').value = new Date().toISOString().slice(0, 7);
        };

        // L∆∞u d·ªØ li·ªáu v√†o localStorage
        function saveData() {
            localStorage.setItem('employees', JSON.stringify(employees));
            localStorage.setItem('attendanceRecords', JSON.stringify(attendanceRecords));
            localStorage.setItem('leaveRecords', JSON.stringify(leaveRecords));
            localStorage.setItem('salaryRecords', JSON.stringify(salaryRecords));
        }

        // Load d·ªØ li·ªáu t·ª´ localStorage
        function loadData() {
            const savedEmployees = localStorage.getItem('employees');
            const savedAttendance = localStorage.getItem('attendanceRecords');
            const savedLeave = localStorage.getItem('leaveRecords');
            const savedSalary = localStorage.getItem('salaryRecords');

            if (savedEmployees) employees = JSON.parse(savedEmployees);
            if (savedAttendance) attendanceRecords = JSON.parse(savedAttendance);
            if (savedLeave) leaveRecords = JSON.parse(savedLeave);
            if (savedSalary) salaryRecords = JSON.parse(savedSalary);

            renderEmployees();
            renderAttendance();
            renderLeave();
            renderSalary();
            updateStats();
            updateEmployeeSelects();
        }

        // Chuy·ªÉn tab
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'reports') {
                updateReports();
            }
        }

        // M·ªü modal th√™m nh√¢n vi√™n
        function openAddEmployeeModal() {
            document.getElementById('modalTitle').textContent = 'Th√™m Nh√¢n Vi√™n M·ªõi';
            document.getElementById('employeeForm').reset();
            editingIndex = -1;
            document.getElementById('employeeModal').classList.add('active');
        }

        // ƒê√≥ng modal
        function closeEmployeeModal() {
            document.getElementById('employeeModal').classList.remove('active');
        }

        // X·ª≠ l√Ω form th√™m/s·ª≠a nh√¢n vi√™n
        document.getElementById('employeeForm').onsubmit = function(e) {
            e.preventDefault();
            
            const employee = {
                id: document.getElementById('empId').value,
                name: document.getElementById('empName').value,
                email: document.getElementById('empEmail').value,
                phone: document.getElementById('empPhone').value,
                department: document.getElementById('empDepartment').value,
                position: document.getElementById('empPosition').value,
                birthday: document.getElementById('empBirthday').value,
                joinDate: document.getElementById('empJoinDate').value,
                address: document.getElementById('empAddress').value,
                status: 'active'
            };
            
            if (editingIndex === -1) {
                employees.push(employee);
            } else {
                employees[editingIndex] = employee;
            }
            
            saveData();
            closeEmployeeModal();
            renderEmployees();
            updateStats();
            updateEmployeeSelects();
        };

        // Hi·ªÉn th·ªã danh s√°ch nh√¢n vi√™n
        function renderEmployees(filteredEmployees = null) {
            const tbody = document.getElementById('employeeTableBody');
            const list = filteredEmployees || employees;
            
            if (list.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 40px; color: #999;">Kh√¥ng t√¨m th·∫•y nh√¢n vi√™n n√†o</td></tr>';
                return;
            }
            
            tbody.innerHTML = list.map((emp, index) => `
                <tr>
                    <td><strong>${emp.id}</strong></td>
                    <td>${emp.name}</td>
                    <td>${emp.department}</td>
                    <td>${emp.position}</td>
                    <td>${emp.email}</td>
                    <td>${emp.phone}</td>
                    <td><span class="badge badge-active">ƒêang l√†m vi·ªác</span></td>
                    <td>
                        <div class="action-btns">
                            <button class="btn btn-secondary" onclick="editEmployee(${employees.indexOf(emp)})">‚úèÔ∏è</button>
                            <button class="btn btn-danger" onclick="deleteEmployee(${employees.indexOf(emp)})">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        // T√¨m ki·∫øm nh√¢n vi√™n
        function searchEmployees() {
            const searchTerm = document.getElementById('searchEmployee').value.toLowerCase();
            const department = document.getElementById('filterDepartment').value;
            
            const filtered = employees.filter(emp => {
                const matchSearch = emp.name.toLowerCase().includes(searchTerm) || 
                                  emp.id.toLowerCase().includes(searchTerm) ||
                                  emp.department.toLowerCase().includes(searchTerm);
                const matchDepartment = !department || emp.department === department;
                return matchSearch && matchDepartment;
            });
            
            renderEmployees(filtered);
        }

        // S·ª≠a nh√¢n vi√™n
        function editEmployee(index) {
            editingIndex = index;
            const emp = employees[index];
            
            document.getElementById('modalTitle').textContent = 'Ch·ªânh S·ª≠a Nh√¢n Vi√™n';
            document.getElementById('empId').value = emp.id;
            document.getElementById('empName').value = emp.name;
            document.getElementById('empEmail').value = emp.email;
            document.getElementById('empPhone').value = emp.phone;
            document.getElementById('empDepartment').value = emp.department;
            document.getElementById('empPosition').value = emp.position;
            document.getElementById('empBirthday').value = emp.birthday;
            document.getElementById('empJoinDate').value = emp.joinDate;
            document.getElementById('empAddress').value = emp.address;
            
            document.getElementById('employeeModal').classList.add('active');
        }

        // X√≥a nh√¢n vi√™n
        function deleteEmployee(index) {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a nh√¢n vi√™n n√†y?')) {
                employees.splice(index, 1);
                saveData();
                renderEmployees();
                updateStats();
                updateEmployeeSelects();
            }
        }

        // C·∫≠p nh·∫≠t dropdown ch·ªçn nh√¢n vi√™n
        function updateEmployeeSelects() {
            const selects = ['attendanceEmployee', 'leaveEmployee', 'salaryEmployee'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                select.innerHTML = '<option value="">-- Ch·ªçn nh√¢n vi√™n --</option>' + 
                    employees.map((emp, idx) => `<option value="${idx}">${emp.name} (${emp.id})</option>`).join('');
            });
        }

        // Th√™m ch·∫•m c√¥ng
        function addAttendance() {
            const empIndex = document.getElementById('attendanceEmployee').value;
            const date = document.getElementById('attendanceDate').value;
            const checkIn = document.getElementById('checkInTime').value;
            const checkOut = document.getElementById('checkOutTime').value;
            
            if (!empIndex || !date || !checkIn || !checkOut) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                return;
            }
            
            const employee = employees[empIndex];
            const hours = calculateHours(checkIn, checkOut);
            
            attendanceRecords.push({
                employee: employee.name,
                date: date,
                checkIn: checkIn,
                checkOut: checkOut,
                hours: hours,
                status: hours >= 8 ? 'ƒê·ªß gi·ªù' : 'Thi·∫øu gi·ªù'
            });
            
            saveData();
            renderAttendance();
            updateStats();
            alert('ƒê√£ l∆∞u ch·∫•m c√¥ng th√†nh c√¥ng!');
        }

        // T√≠nh s·ªë gi·ªù l√†m vi·ªác
        function calculateHours(checkIn, checkOut) {
            const start = new Date('2000-01-01 ' + checkIn);
            const end = new Date('2000-01-01 ' + checkOut);
            const diff = (end - start) / (1000 * 60 * 60);
            return Math.max(0, diff).toFixed(1);
        }

        // Hi·ªÉn th·ªã l·ªãch s·ª≠ ch·∫•m c√¥ng
        function renderAttendance() {
            const tbody = document.getElementById('attendanceTableBody');
            
            if (attendanceRecords.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center; padding: 40px; color: #999;">Ch∆∞a c√≥ d·ªØ li·ªáu ch·∫•m c√¥ng</td></tr>';
                return;
            }
            
            tbody.innerHTML = attendanceRecords.slice().reverse().map(record => `
                <tr>
                    <td>${record.date}</td>
                    <td>${record.employee}</td>
                    <td>${record.checkIn}</td>
                    <td>${record.checkOut}</td>
                    <td>${record.hours}h</td>
                    <td><span class="badge ${record.status === 'ƒê·ªß gi·ªù' ? 'badge-active' : 'badge-inactive'}">${record.status}</span></td>
                </tr>
            `).join('');
        }

        // Th√™m ƒë∆°n ngh·ªâ ph√©p
        function addLeave() {
            const empIndex = document.getElementById('leaveEmployee').value;
            const type = document.getElementById('leaveType').value;
            const startDate = document.getElementById('leaveStartDate').value;
            const endDate = document.getElementById('leaveEndDate').value;
            const reason = document.getElementById('leaveReason').value;
            
            if (!empIndex || !startDate || !endDate) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                return;
            }
            
            const employee = employees[empIndex];
            const days = calculateLeaveDays(startDate, endDate);
            
            leaveRecords.push({
                employee: employee.name,
                type: type,
                startDate: startDate,
                endDate: endDate,
                days: days,
                reason: reason,
                status: 'Ch·ªù duy·ªát'
            });
            
            saveData();
            renderLeave();
            updateStats();
            
            document.getElementById('leaveReason').value = '';
            alert('ƒê√£ ƒëƒÉng k√Ω ngh·ªâ ph√©p th√†nh c√¥ng!');
        }

        // T√≠nh s·ªë ng√†y ngh·ªâ
        function calculateLeaveDays(start, end) {
            const startDate = new Date(start);
            const endDate = new Date(end);
            const diff = (endDate - startDate) / (1000 * 60 * 60 * 24);
            return Math.max(1, diff + 1);
        }

        // Hi·ªÉn th·ªã danh s√°ch ngh·ªâ ph√©p
        function renderLeave() {
            const tbody = document.getElementById('leaveTableBody');
            
            if (leaveRecords.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 40px; color: #999;">Ch∆∞a c√≥ ƒë∆°n ngh·ªâ ph√©p n√†o</td></tr>';
                return;
            }
            
            tbody.innerHTML = leaveRecords.slice().reverse().map((record, index) => {
                const actualIndex = leaveRecords.length - 1 - index;
                return `
                <tr>
                    <td>${record.employee}</td>
                    <td>${record.type}</td>
                    <td>${record.startDate}</td>
                    <td>${record.endDate}</td>
                    <td>${record.days} ng√†y</td>
                    <td>${record.reason}</td>
                    <td><span class="badge badge-leave">${record.status}</span></td>
                    <td>
                        <div class="action-btns">
                            <button class="btn btn-secondary" onclick="approveLeave(${actualIndex})">‚úÖ</button>
                            <button class="btn btn-danger" onclick="rejectLeave(${actualIndex})">‚ùå</button>
                        </div>
                    </td>
                </tr>
            `}).join('');
        }

        // Duy·ªát ngh·ªâ ph√©p
        function approveLeave(index) {
            leaveRecords[index].status = 'ƒê√£ duy·ªát';
            saveData();
            renderLeave();
        }

        // T·ª´ ch·ªëi ngh·ªâ ph√©p
        function rejectLeave(index) {
            leaveRecords[index].status = 'T·ª´ ch·ªëi';
            saveData();
            renderLeave();
        }

        // T√≠nh l∆∞∆°ng
        function calculateSalary() {
            const empIndex = document.getElementById('salaryEmployee').value;
            const month = document.getElementById('salaryMonth').value;
            const baseSalary = parseFloat(document.getElementById('baseSalary').value) || 0;
            const allowance = parseFloat(document.getElementById('allowance').value) || 0;
            const bonus = parseFloat(document.getElementById('bonus').value) || 0;
            const deduction = parseFloat(document.getElementById('deduction').value) || 0;
            
            if (!empIndex || !month || baseSalary === 0) {
                alert('Vui l√≤ng ƒëi·ªÅn ƒë·∫ßy ƒë·ªß th√¥ng tin!');
                return;
            }
            
            const employee = employees[empIndex];
            const totalSalary = baseSalary + allowance + bonus - deduction;
            
            salaryRecords.push({
                month: month,
                employee: employee.name,
                baseSalary: baseSalary,
                allowance: allowance,
                bonus: bonus,
                deduction: deduction,
                total: totalSalary,
                status: 'ƒê√£ t√≠nh'
            });
            
            saveData();
            renderSalary();
            updateStats();
            alert(`ƒê√£ t√≠nh l∆∞∆°ng cho ${employee.name}: ${formatCurrency(totalSalary)}`);
        }

        // Hi·ªÉn th·ªã b·∫£ng l∆∞∆°ng
        function renderSalary() {
            const tbody = document.getElementById('salaryTableBody');
            
            if (salaryRecords.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center; padding: 40px; color: #999;">Ch∆∞a c√≥ b·∫£ng l∆∞∆°ng n√†o</td></tr>';
                return;
            }
            
            tbody.innerHTML = salaryRecords.slice().reverse().map(record => `
                <tr>
                    <td>${record.month}</td>
                    <td>${record.employee}</td>
                    <td>${formatCurrency(record.baseSalary)}</td>
                    <td>${formatCurrency(record.allowance)}</td>
                    <td>${formatCurrency(record.bonus)}</td>
                    <td>${formatCurrency(record.deduction)}</td>
                    <td><strong>${formatCurrency(record.total)}</strong></td>
                    <td><span class="badge badge-active">${record.status}</span></td>
                </tr>
            `).join('');
        }

        // Format ti·ªÅn t·ªá
        function formatCurrency(amount) {
            return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
        }

        // C·∫≠p nh·∫≠t th·ªëng k√™
        function updateStats() {
            document.getElementById('totalEmployees').textContent = employees.length;
            document.getElementById('activeEmployees').textContent = employees.filter(e => e.status === 'active').length;
            
            const today = new Date().toISOString().slice(0, 10);
            const onLeave = leaveRecords.filter(r => 
                r.status === 'ƒê√£ duy·ªát' && 
                r.startDate <= today && 
                r.endDate >= today
            ).length;
            document.getElementById('onLeaveToday').textContent = onLeave;
        }

        // C·∫≠p nh·∫≠t b√°o c√°o
        function updateReports() {
            const totalSalary = salaryRecords.reduce((sum, r) => sum + r.total, 0);
            document.getElementById('totalSalaryThisMonth').textContent = formatCurrency(totalSalary);
            
            document.getElementById('totalWorkDays').textContent = attendanceRecords.length;
            
            const totalLeave = leaveRecords.filter(r => r.status === 'ƒê√£ duy·ªát').reduce((sum, r) => sum + r.days, 0);
            document.getElementById('totalLeaveDays').textContent = totalLeave;
            
            const attendanceRate = attendanceRecords.length > 0 ? 
                (attendanceRecords.filter(r => r.status === 'ƒê·ªß gi·ªù').length / attendanceRecords.length * 100).toFixed(1) : 100;
            document.getElementById('attendanceRate').textContent = attendanceRate + '%';
            
            renderDepartmentReport();
        }

        // B√°o c√°o theo ph√≤ng ban
        function renderDepartmentReport() {
            const tbody = document.getElementById('departmentReportBody');
            const departments = ['K·ªπ Thu·∫≠t', 'Kinh Doanh', 'Marketing', 'Nh√¢n S·ª±', 'K·∫ø To√°n'];
            
            if (employees.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; padding: 40px; color: #999;">Ch∆∞a c√≥ d·ªØ li·ªáu</td></tr>';
                return;
            }
            
            tbody.innerHTML = departments.map(dept => {
                const count = employees.filter(e => e.department === dept).length;
                const percentage = employees.length > 0 ? (count / employees.length * 100).toFixed(1) : 0;
                return `
                    <tr>
                        <td><strong>${dept}</strong></td>
                        <td>${count} ng∆∞·ªùi</td>
                        <td>${percentage}%</td>
                    </tr>
                `;
            }).join('');
        }
    </script>
</body>
</html>